sudo: false
branches:
  only:
    - sources
env:
  global:
    - GH_REF: github.com/DavisSedley/DavidSedley.github.io.git
    - secure: "ttYPkpspfMXW/aM4T22BObL/qprD6qo2XVszL/mxJkCO4dnUaOJhFdStYry+FBBhg3lOqS6DhcPpkgMC6X2BBo5NX8cwegdrTMFrmtS97VuTqo/Z1R/hWiXHjmH/KnrmhwpZsLtYEg48J+VzfZXbTG6o+ggrSVRS8DLQYsMU9robTxse7qcCsrsviklewOHyXDDOKdsqGHJ8U4Ls/jadGiCEZ7RFWAcz8S76Fi9IZff6KOUIpyC+0cfMwLYywRs7GFg8Gt/4tovaHZsvVXKYCuvbaE0pS/mrveW5nNDNCpOrJRZErfcsV7ZeeVYS4TA8d/pFxEQPc3SEHlndVpaFRGqlotbqUuzhTQyldRu+YBCK09F5E+Nv55QYD7d6OT2YcIYYBv8S9tqgjc9xw5k5Ul/MZDZ1GzPx7cWUJ2SFMYGY8ae1+JjYt0A4z9rR2FUtbVKU/tsyxm5SvEl9XHvf7Z2Ep7reH5SB/K5VrNhtA1LUgcXqmO+crh+NSSaqMCS+oGu6b8P4rWliCdZCRwaHIIvVbwtvkAbm3J625VDha3EKhA9Y+4Ljf3elBMBtjU9z0njxT40EoMU8mD0qdRw1WOcHjsIIASMTuhu4J1TUj2ZEkb6ee3SvV+iieIj0z69D81YiWR9EZFl9UjTQ3z9KFThDaindhPI8C4YgIt6u1wU="

  matrix:
    - GOPATH=$TRAVIS_BUILD_DIR/gosrc
install:
  - mkdir -p "$TRAVIS_BUILD_DIR/gosrc"
  - mkdir -p "$TRAVIS_BUILD_DIR/static"
  - go get -v github.com/spf13/hugo
cache:
  directories:
  - ${GOPATH}
script: ${GOPATH}/bin/hugo --buildDrafts
after_success:
  - cd public
  - ls
  - git init
  - git config user.email "travis@example.com"
  - git config user.name "Travis ci"
  - git add .
  - git commit -m "snapshot $(date '+%m/%d/%y %H:%M')"
  - git push --force --quiet "https://${GH_TOKEN}@github.com/DavidSedley/DavidSedley.github.io.git" master:master 2>&1 >/dev/null
